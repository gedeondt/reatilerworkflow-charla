{
  "name": "Corporate Onboarding Saga",
  "version": 2,
  "domains": [
    {
      "id": "hr",
      "queue": "hr",
      "publishes": [
        {
          "name": "EmployeeHired",
          "start": true,
          "payloadSchema": {
            "employeeId": "string",
            "fullName": "string",
            "department": "string",
            "startDate": "string"
          }
        },
        {
          "name": "EmployeeCreated",
          "payloadSchema": {
            "employeeId": "string",
            "fullName": "string",
            "department": "string",
            "email": "string"
          }
        },
        {
          "name": "EmployeeActivated",
          "payloadSchema": {
            "employeeId": "string",
            "activationDate": "string"
          }
        }
      ],
      "listeners": [
        {
          "id": "hr-on-EmployeeHired",
          "delayMs": 50,
          "on": { "event": "EmployeeHired" },
          "actions": [
            {
              "type": "emit",
              "event": "EmployeeCreated",
              "mapping": {
                "employeeId": "employeeId",
                "fullName": "fullName",
                "department": "department",
                "email": { "const": "employee@corp.example" }
              }
            }
          ]
        },
        {
          "id": "hr-on-AccessGranted",
          "delayMs": 80,
          "on": { "event": "AccessGranted", "fromDomain": "security" },
          "actions": [
            {
              "type": "emit",
              "event": "EmployeeActivated",
              "mapping": {
                "employeeId": "employeeId",
                "activationDate": { "const": "2025-01-01" }
              }
            }
          ]
        }
      ]
    },
    {
      "id": "payroll",
      "queue": "payroll",
      "publishes": [
        {
          "name": "PayrollAccountCreated",
          "payloadSchema": {
            "employeeId": "string",
            "payrollAccountId": "string",
            "salary": "number",
            "email": "string"
          }
        }
      ],
      "listeners": [
        {
          "id": "payroll-on-EmployeeCreated",
          "delayMs": 120,
          "on": { "event": "EmployeeCreated", "fromDomain": "hr" },
          "actions": [
            {
              "type": "emit",
              "event": "PayrollAccountCreated",
              "mapping": {
                "employeeId": "employeeId",
                "payrollAccountId": { "const": "PAYROLL-001" },
                "salary": { "const": 50000 },
                "email": "email"
              }
            }
          ]
        }
      ]
    },
    {
      "id": "it",
      "queue": "it",
      "publishes": [
        {
          "name": "ITAccountCreated",
          "payloadSchema": {
            "employeeId": "string",
            "itAccountId": "string",
            "email": "string"
          }
        }
      ],
      "listeners": [
        {
          "id": "it-on-PayrollAccountCreated",
          "delayMs": 200,
          "on": { "event": "PayrollAccountCreated", "fromDomain": "payroll" },
          "actions": [
            {
              "type": "emit",
              "event": "ITAccountCreated",
              "mapping": {
                "employeeId": "employeeId",
                "itAccountId": { "const": "IT-001" },
                "email": "email"
              }
            }
          ]
        }
      ]
    },
    {
      "id": "facilities",
      "queue": "facilities",
      "publishes": [
        {
          "name": "FacilitiesReady",
          "payloadSchema": {
            "employeeId": "string",
            "deskId": "string",
            "building": "string",
            "floor": "string"
          }
        }
      ],
      "listeners": [
        {
          "id": "facilities-on-ITAccountCreated",
          "delayMs": 200,
          "on": { "event": "ITAccountCreated", "fromDomain": "it" },
          "actions": [
            {
              "type": "emit",
              "event": "FacilitiesReady",
              "mapping": {
                "employeeId": "employeeId",
                "deskId": { "const": "D-101" },
                "building": { "const": "HQ" },
                "floor": { "const": "1" }
              }
            }
          ]
        }
      ]
    },
    {
      "id": "security",
      "queue": "security",
      "publishes": [
        {
          "name": "AccessGranted",
          "payloadSchema": {
            "employeeId": "string",
            "badgeId": "string"
          }
        }
      ],
      "listeners": [
        {
          "id": "security-on-FacilitiesReady",
          "delayMs": 150,
          "on": { "event": "FacilitiesReady", "fromDomain": "facilities" },
          "actions": [
            {
              "type": "emit",
              "event": "AccessGranted",
              "mapping": {
                "employeeId": "employeeId",
                "badgeId": { "const": "BADGE-001" }
              }
            }
          ]
        }
      ]
    }
  ]
}
